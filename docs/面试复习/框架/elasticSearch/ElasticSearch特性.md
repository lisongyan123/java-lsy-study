# MySQL和ElasticSearch对比:

| MySQL               | ElasticSearch             | 
|:--------------------|:--------------------------| 
| Table               | Index                     |
| Table               | Type                      |
| Row                 | Document                  |
| Column              | Field                     |
| Schema              | Mapping                   |
| Index               | Everything is indexed     |
| SQL                 | Query DSL                 |
| select * from …     | GET  http://…             |
| update table set …     | POST  http://…            |
| group by、avg、sum       | Aggregations              |
| 去重 distinct            | cardinality               |
| 数据迁移                   | reindex                   |

# 为什么选择 ElasticSearch

1. 横向扩展方便, 可代替 NoSQL, 索引和查询世家因多因素而异, 要考虑数据量, 另一方面是项目/产品的指标要求, 压测工具达到吞吐量和 CPU 利用率指标要求
2. 新系统开发使用 ES 作为存储检索服务器
3. 系统升级徐支持全文检索服务
4. 节点职责, 包含主节点(Master)、数据节点(Data)、客户端/路由节点(Client), 大多数大规模集群选择专用主节点, 选择数据和客户端节点, 职责分离, 客户端处理 Http 请求, 数据节点为查询提供服务

# 学习路程: 

**增删改查**

1. 索引的增删改查
2. 文档的增删改查
3. Mapping
4. template

**非增删改查**

1. 数据预处理Ingest
2. 自定义分词
3. 检索分类
4. 聚合分类
5. 节点角色分类
6. 集群备份与快照
7. 集群安全
8. 跨集群部署
9. 冷热集群架构
10. 跨机房跨鸡架检索

# ElasticSearch认知升级

1. 搜索分析引擎
2. logstash: 数据处理管道, 从多个来源采集数据, 转换数据, 价格数据发送到 es
3. Beats: 数据采集器
4. kibana: 图形和图表对 ElasticSearch 数据进行可视化和探索分析

# 典型场景

### 支持场景
1. 数据安全场景: ElasticSearch 的 shard 支持 replication, 一份数据可以保存多份, 某一台机器挂了, 数据在其他机器还有
2. 访问安全场景: 随着 x-pack 开源, ElastcSearch 支持验证, 不用担心未授权访问, 借助第三方 search-guard
3. 迁移特性: ElasticSearch 支持众多插件, 导入到处数据都很简单

### 搜索服务
1. 典型场景

- 仪表盘搜索
- 电子商务
- 手机应用搜索
- 地理位置搜索

2. 主要特性

- 高性能: 高并发、低延迟的搜索体验
- 强相关: 自定义打分、排序机制
- 高可用: 机房、机架感知, 异地容灾

### 实时日志分析
1. 典型场景
- 业务日志: 用户行为日志、应用日志
- 状态日志: 慢查询、异常探测
- 系统日志: debug、info、warn、error、fatal 

2. 主要特性
- 实时性: 从日志产生到可访问, 秒级
- 全文搜索: 基于倒排索引, 支持灵活的搜索分析
- 交互式分析: 万亿级日志, 搜索秒级响应

### 商业智能BI
1. 典型场景
电子商务、移动应用、广告媒体等业务都需要借助数据分析和数据挖掘来辅助商业决策, 而规模庞大的业务数据对数据的统计分析造成了很大的挑战
2. 主要特性
- ES 拥有结构化查询的能力, 支持复杂的过滤和聚合统计功能
- 帮助客户对海量数据进行高效地个性化统计分析、发现问题与机会、辅助商业决策, 让数据产生真正的价值

# 实战例子:

1. 惯性思维认为创建索引、指定 Mapping 顺理成章, 模板 template 在数据量不大、索引不多的情况下根本用不到, 通过脚本创建 Mapping
2. Ingest 数据预处理, 类似与 ETL 环节, 写代码实现, 字段拆解、截取、更换字段名
3. github 使用 ElasticSearch 做 PB 级别的搜索
4. 百度目前广泛使用 ElasticSearch 作文本数据分析, 对数据做多维度展示, 分析实例异常和业务层面异常, 目前覆盖20哥业务线, 单集群最大100台机器, 200个ES节点, 每天导入30TB数据
5. ES在某些场景下代替传统DB, 对事务没有特殊要求, 权限管理不用那么细